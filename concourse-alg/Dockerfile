FROM ubuntu:latest

RUN apt-get update && apt-get -y upgrade && DEBIAN_FRONTEND=noninteractive apt-get -y install python3-pip libarchive-tools ruby rubygems links wget curl bash zip unzip git jq gettext-base  && rm -rf /var/lib/apt/lists/* 
RUN cd /usr/bin && curl https://releases.hashicorp.com/vault/ | grep -o "vault/\([0-9]\.\?\)\+/" | sort -r | head -n1 |  xargs -I{} bash -c 'curl https://releases.hashicorp.com/$1' -- {} | grep -o "/vault/.*/[a-zA-Z0-9_.]*linux_amd64.zip" | xargs -I{} bash -c 'curl -o - https://releases.hashicorp.com$1' -- {}  | bsdtar -xvf- && chmod ugo+x vault && curl --silent "https://api.github.com/repos/cloudfoundry/bosh-cli/releases/latest" | grep -o "https://.*download/.*linux-amd64" | xargs  wget  -O ./bosh && chmod ugo+x bosh && curl -L --silent "https://api.github.com/repos/cloudfoundry-incubator/credhub-cli/releases/latest" | jq -r '.assets[]|select(.name | test("credhub-linux-[0-9]*.[0-9]*.[0-9]*.tgz"))|.browser_download_url' | xargs curl -L | tar -xvz  && chmod ugo+x credhub && curl --silent "https://api.github.com/repos/pivotal-cf/om/releases/latest" | jq -r '.assets[]|select(.name | test("om-linux-[0-9]*.[0-9]*.[0-9]*$")).browser_download_url' | xargs wget -O om  && chmod +x om && curl -L "https://packages.cloudfoundry.org/stable?release=linux64-binary&version=v7&source=github" | tar -zx && mv cf7 /usr/local/bin/cf
RUN  pip3 install yq
